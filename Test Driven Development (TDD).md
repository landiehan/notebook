# Test Driven Development (TDD)

> è¿™ä¸€éƒ¨åˆ†çš„ç›®æ ‡æ˜¯å­¦ä¹ TDDçš„åŸºç¡€ï¼Œç†è§£æµ‹è¯•æ˜¯æ€ä¹ˆæ•è·å’Œè¯†åˆ«ä»£ç é‡Œçš„é—®é¢˜ã€‚

ä¸»è¦å†…å®¹ï¼š

- æ€ä¹ˆå†™ä¸€ä¸ª*è‡ªåŠ¨æµ‹è¯•å¥—ä»¶ ï¼ˆautomated test suiteï¼‰*
- æè¿°ä¸€ä¸ªæµ‹è¯•å¥—ä»¶åœ¨è½¯ä»¶å¼€å‘ä¸­æ˜¯æ€ä¹ˆä½¿ç”¨çš„
- è§£é‡Šè‡ªåŠ¨æµ‹è¯•çš„å¥½å¤„
- ä½¿ç”¨Mochaå’ŒChaiå†™æµ‹è¯•
- ä½¿ç”¨TDDæŠ€æœ¯å†™ç¨‹åº

## 2çº§æ ‡é¢˜

### æ‰‹åŠ¨æµ‹è¯•

*è½¯ä»¶æµ‹è¯•*æ˜¯è¯„ä¼°è½¯ä»¶å®Œæˆåº¦å’Œè´¨é‡çš„è¿‡ç¨‹ã€‚é€šå¸¸å‘¢æ˜¯æ‰§è¡Œä¸€ä¸‹ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œæ¯”è¾ƒä¸€ä¸‹å®é™…çš„è¡¨ç°å’Œé¢„æœŸçš„è¡¨ç°ã€‚

ä¸€ç§å½¢å¼æ˜¯*æ‰‹åŠ¨æµ‹è¯•*ã€‚åœ¨webåº”ç”¨é‡Œé¢å‘¢ï¼Œå¯èƒ½æ˜¯åœ¨é¡µé¢é‡Œç‚¹å‡»ã€æ‹–æ‹½æˆ–è€…è¾“å…¥ä¹‹ç±»çš„ã€‚

### è‡ªåŠ¨æµ‹è¯•

å¦ä¸€ç§å½¢å¼å°±æ˜¯*è‡ªåŠ¨æµ‹è¯•*ã€‚ç›¸æ¯”äºæ‰‹åŠ¨çš„ï¼Œæ›´å¿«ã€æ›´å¯é ã€å¯ç»´æŠ¤ã€‚è‡ªåŠ¨æµ‹è¯•çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š

1. å†™ä»£ç å’Œå¯¹åº”çš„æµ‹è¯•
2. åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤æ‰§è¡Œæµ‹è¯•
3. å¦‚æœåº”ç”¨çš„è¡¨ç°ç¬¦åˆé¢„æœŸï¼Œåˆ™æµ‹è¯•é€šè¿‡ï¼Œå¼€å‘å®Œæˆã€‚
4. å¦‚æœåº”ç”¨çš„è¡¨ç°ä¸ç¬¦åˆé¢„æœŸï¼Œè‡³å°‘ä¼šæœ‰ä¸€ä¸ªæµ‹è¯•å¤±è´¥ï¼Œæ ¹æ®æç¤ºä¿®å¤ä»£ç ï¼Œé‡å¤ç¬¬2æ­¥ã€‚

### æµ‹è¯•å¥—ä»¶

> æµ‹è¯•ä¹Ÿæ˜¯ä»£ç ï¼Œå¯ä»¥æŠŠå®šä¹‰åº”ç”¨ç¨‹åºçš„ä»£ç ç§°ä¸º*å®ç°ä»£ç *ï¼ŒæŠŠå®šä¹‰æµ‹è¯•çš„ä»£ç ç§°ä¸º*æµ‹è¯•ä»£ç *ã€‚

æµ‹è¯•çš„é›†åˆç§°ä¹‹ä¸ºæµ‹è¯•å¥—ä»¶ï¼ˆtest suiteï¼‰ã€‚

### ä½œä¸ºæ–‡æ¡£çš„æµ‹è¯•ä»¬

æ–‡æ¡£æ˜¯ä¸å®ç°ä»£ç åˆ†å¼€çš„ä»»ä½•å†…å®¹ï¼Œè¿™äº›å†…å®¹è§£é‡Šäº†åº”ç”¨æ˜¯å¦‚ä½•å·¥ä½œæˆ–å¦‚ä½•ä½¿ç”¨çš„ã€‚

æ–‡æ¡£å¯ä»¥æ˜¯å¾ˆå¤šå½¢å¼ï¼ŒåŒ…æ‹¬çº¯æ–‡æœ¬ï¼Œå›¾è¡¨......å’Œæµ‹è¯•ï¼æµ‹è¯•ä½œä¸ºæ–‡æ¡£çš„è¯ï¼Œè¿˜æä¾›äº†å¯æ‰§è¡Œçš„ä»£ç ï¼Œç¡®ä¿åº”ç”¨æŒ‰ç…§æè¿°è¿è¡Œã€‚

### regression

å½“æ·»åŠ æ–°åŠŸèƒ½æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼Œå¦‚æœé”™è¯¯å‡ºç°åœ¨ä»¥å‰å¼€å‘çš„åŠŸèƒ½é‡Œé¢ï¼Œç§°ä¹‹ä¸º*regression*ã€‚å…·ä½“åˆ°æŸä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥è¯´é‚£ä¸ªå‡½æ•°*regressed*ã€‚

å¦‚æœå‘ç”Ÿäº†regressionï¼Œæ‰§è¡Œæµ‹è¯•çš„è¾“å‡ºä¼šæœ‰æç¤ºã€‚

### æ€»ç»“

è‡ªåŠ¨æµ‹è¯•å‘¢åœ¨ç¼–å†™çš„æ—¶å€™ä¼šæ¶ˆè€—ä¸€äº›æ—¶é—´ï¼Œä½†æ˜¯è¿™ä¸ªèŠ±è´¹å¯¹æ¯”äºä»–çš„æ”¶ç›Šæ˜¯å¾ˆå°çš„ã€‚è‡ªåŠ¨æµ‹è¯•æœ‰è¿™äº›å¥½å¤„ï¼š

- æé«˜äº†ä½ çš„è‡ªä¿¡ï¼ˆç›¸æ¯”äºæ‰‹åŠ¨æµ‹è¯•ï¼Œä½ å¯ä»¥ä¿è¯ä½ çš„äº§å“æŒ‰ç…§é¢„æœŸè¿è¡Œï¼‰ã€‚
- æ”¹è¿›äº†æ–‡æ¡£ã€‚
- å‡å°‘äº†regressionçš„å¯èƒ½æ€§ã€‚

## ä»€ä¹ˆæ˜¯TDD

![TDD-Cycle](C:\Users\Landi\Desktop\notebook\TDD-Cycle.png)

RED (test failed) => GREEN (test passes) => REFACTOR

## ä½¿ç”¨Mochaå†™æµ‹è¯•

### ä»‹ç»

Mochaæ˜¯ä¸€ä¸ª*æµ‹è¯•æ¡†æ¶ï¼ˆtest frameworkï¼‰*ã€‚ä½¿ç”¨æµ‹è¯•æ¡†æ¶å¯ä»¥ç»„ç»‡ï¼ˆorganizeï¼‰å’Œè‡ªåŠ¨åŒ–ï¼ˆautomateï¼‰æµ‹è¯•ï¼Œè€Œä¸ç”¨æ‰‹åŠ¨æµ‹è¯•æ¯ä¸€ä¸ªå‡½æ•°ã€‚

è¿™ä¸€å°èŠ‚å­¦ä¹ å†…å®¹ï¼š

- å­¦ä¹ å†™ä¸€ä¸ªåŸºç¡€çš„Mochaæµ‹è¯•å¥—ä»¶
- ä½¿ç”¨Nodeçš„`assert.ok`æ–¹æ³•æ¥éªŒè¯ä»£ç çš„é¢„æœŸè¾“å‡º
- ç†è§£ã€åº”ç”¨æµ‹è¯•çš„å››ä¸ªé˜¶æ®µï¼Œæ¥åˆ›å»ºè¡¨è¾¾æ€§çš„ï¼ˆexpressiveï¼‰æµ‹è¯•å¥—ä»¶
- è¯„ä¼°æµ‹è¯•çš„è´¨é‡

### å®‰è£…Mocha - 1

åœ¨å†™æµ‹è¯•ä»£ç ä¹‹å‰ï¼Œéœ€è¦ä½¿ç”¨Node.jså’Œnpmæ¥åˆ›å»ºä¸€ä¸ªJavaScripté¡¹ç›®ï¼Œç„¶åå®‰è£…Mochaã€‚

- *Node*è®©æˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯è¿è¡ŒJavaScriptã€‚
- *npm*æ˜¯ä¸€ä¸ªNodeå·¥å…·ï¼Œç”¨æ¥ä¸‹è½½ã€å®‰è£…å’Œç®¡ç†åŒ…ã€‚
- *Mocha*æ˜¯ç”¨æ¥æµ‹è¯•JavaScriptä»£ç çš„åŒ…ã€‚

ç„¶åæ‰§è¡Œï¼š

```bash
npm init
npm i mocha -D
```

### å®‰è£…Mocha - 2

è¦è¿è¡ŒMochaï¼Œéœ€è¦ç°åœ¨**package.json**çš„`scripts`å¯¹è±¡é‡Œé¢ï¼ŒæŠŠ`"test"`çš„å€¼è®¾ç½®æˆ`mocha`ã€‚ç„¶åå°±å¯ä»¥é€šè¿‡ï¼š

```bash
npm test
```

### describeå’Œit

é€šå¸¸ç±»æ¯”å®ç°ä»£ç çš„ç»“æ„æ¥ç»„ç»‡æµ‹è¯•ä»£ç çš„ç»“æ„ã€‚ç”¨describeè¡¨ç¤ºä¸€ç»„æµ‹è¯•ï¼Œitè¡¨ç¤ºä¸€ä¸ªæµ‹è¯•ã€‚è¿™ä¿©éƒ½æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªstringï¼Œæè¿°æµ‹è¯•å†…å®¹ï¼Œä¸€ä¸ªæ˜¯å›è°ƒå‡½æ•°ï¼Œåœ¨è¿™é‡Œå†™æµ‹è¯•ä»£ç ã€‚

### assert

æµ‹è¯•æ˜¯ç”¨æ¥æ¯”è¾ƒé¢„æœŸè¾“å‡ºå’Œå®é™…è¾“å‡ºçš„ã€‚

ä½œä¸ºä¸€ä¸ªNodeæ¨¡å—ï¼Œå¯ä»¥requireå®ƒã€‚

```javascript
const assert = require('assert');
assert.ok();
```

å¦‚æœä¼ ç»™`assert.ok`çš„æ˜¯`false`ï¼Œå°±ä¼šæœ‰`AssertionError`é”™è¯¯æŠ›å‡ºã€‚è¿™ä¸ªé”™è¯¯ç»™Mochaæ±‡æŠ¥ï¼Œè¯´testå¤±è´¥äº†ï¼Œç„¶åMochaä¼šlogé”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°ã€‚

### Setup, Exercise, Verify

å¥½çš„æµ‹è¯•ä»£ç æ¸…æ™°çš„åˆ’åˆ†è¿™ä¸‰ä¸ªéƒ¨åˆ†ï¼š

- Setup - åˆ›å»ºæµ‹è¯•éœ€è¦çš„å¯¹è±¡ã€å˜é‡ã€è®¾è®¡æ¡ä»¶ï¼ˆconditionï¼‰
- Exercise - æ‰§è¡Œä½ è¦æµ‹è¯•çš„å‡½æ•°
- Verify - æ£€æŸ¥é¢„æœŸå’Œå®é™…ç»“æœï¼Œå¯ä»¥ç”¨`assert`åº“ã€‚

### Teardown

æœ‰çš„æµ‹è¯•éœ€è¦ç¬¬å››ä¸ªé˜¶æ®µå«åš*teardown*ã€‚

- Teardown - é‡ç½®åœ¨è¿™ä¸ªæµ‹è¯•ä¹‹åæ‰€æœ‰è¢«æ”¹å˜çš„æƒ…å†µã€‚

ç”¨æ¥åœ¨ä¸‹ä¸€ä¸ªæµ‹è¯•æ‰§è¡Œå‰ï¼Œé‡ç½®ç¯å¢ƒï¼Œé˜²æ­¢è¿™ä¸ªæµ‹è¯•çš„ç»“æœå½±å“åˆ«çš„æµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š

- ä¿®æ”¹äº†æ–‡ä»¶å’Œç›®å½•ç»“æ„ï¼Ÿ
- æ”¹å˜æ–‡ä»¶çš„è¯»å†™æƒé™ï¼Ÿ
- ä¿®æ”¹æ•°æ®åº“é‡Œçš„ä¸€æ¡è®°å½•ï¼Ÿ

æœ‰äº›æƒ…å†µå°±ä¸éœ€è¦è¿™ä¸ªé˜¶æ®µï¼Œå› ä¸ºæ²¡æœ‰éœ€è¦é‡ç½®çš„æƒ…å†µã€‚

### Hooks

>  ä¸Šé¢ğŸ‘†å‘¢ï¼Œç”¨teardownåœ¨`it`é‡Œé¢ï¼Œè®©æµ‹è¯•å˜å¾—å­¤ç«‹ï¼Œä½†æ˜¯ä¸å¯é ã€‚ä¸‡ä¸€ä»£ç è¿˜æ²¡æ‰§è¡Œåˆ°teardownï¼Œç³»ç»Ÿå°±å‡ºé”™äº†ï¼Œé‚£å’‹æ•´ï¼Ÿ
>
> è¿™ä¸ªé˜¶æ®µå°±ä¸ä¼šæ‰§è¡Œäº†ï¼Œæ¯”å¦‚ï¼šåœ¨æŸä¸ªæµ‹è¯•ä¸­ï¼Œä½ å…ˆæ‰“å¼€äº†æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œï¼Œç„¶ååœ¨teardowné˜¶æ®µå…³é—­æ–‡ä»¶ï¼Œå¦‚æœè¿™ä¸ªé˜¶æ®µæ²¡æ‰§è¡Œï¼Œæ–‡ä»¶ä¿æŒæ‰“å¼€ï¼Œå¯èƒ½ä¼šåœ¨å°†æ¥çš„æµ‹è¯•ä¸­è¯¯æŠ¥ï¼ˆfalse negativesï¼‰ã€‚
>
> Mochaæä¾›äº†*hooks*æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

hookæ˜¯åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œçš„ä»£ç å—ã€‚å¯ä»¥ç”¨æ¥è®¾ç½®å’Œé‡ç½®æ¡ä»¶ï¼ŒåƒSetupé˜¶æ®µå’Œteardowné˜¶æ®µé‚£æ ·ã€‚

åœ¨Mochaä¸­ï¼Œé’©å­å†™åœ¨`describe`é‡Œé¢ï¼š

```javascript
describe('example', () => {
	afterEach(() => {
		// teardown goes here
	});
	
	it('.sample', () => {
		// test goes here
	})
})
```

ğŸ‘†è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæ¯ä¸€ä¸ª`it`æ‰§è¡Œä¹‹åï¼Œåœ¨`afterEach`é‡Œé¢çš„å‡½æ•°ä¼šè¢«è°ƒç”¨æ‰§è¡Œã€‚

Mochaåº“é‡Œé¢å‘¢è¿˜æœ‰`before()`ï¼Œ`beforeEach()`ï¼Œ`after()`ã€‚

### æ€»ç»“

ç°åœ¨å‘¢ï¼Œå°±å¯ä»¥ç”¨Mochaå’ŒNodeçš„`assert.ok()`å†™æµ‹è¯•å•¦ã€‚è¿˜å­¦äº†è¿™äº›ï¼š

- ä½¿ç”¨npmå®‰è£…Mocha
- ä½¿ç”¨`describe()`å’Œ`it()`ç»„ç»‡æµ‹è¯•ä»£ç ç»“æ„ã€‚
- ä½¿ç”¨å››ä¸ªé˜¶æ®µç¡®ä¿æµ‹è¯•çš„å­¤ç«‹ï¼ˆisolatedï¼‰å’Œå…·æœ‰è¡¨è¾¾æ€§ï¼ˆexpressiveï¼‰ã€‚
- ä½¿ç”¨é’©å­ç¡®ä¿æµ‹è¯•ä»£ç çš„å¯é æ€§ã€‚
- ä½¿ç”¨`assert.ok()`å†™é¢„æœŸå’Œå®é™…çš„æ¯”è¾ƒã€‚

**å¥½çš„æµ‹è¯•6æ¡æ ‡å‡†**ï¼šfast, complete, reliable, isolated, maintainable, and expressiveã€‚